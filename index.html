<!DOCTYPE html><html><head><title>Presentation</title><meta charset="utf-8"><link href="./static/normalize.css" rel="stylesheet" type="text/css"><link href="./static/base.css" rel="stylesheet" type="text/css"></head><body><article><section class="section" id="section-0"><section class="slide" id="slide-0-0" data-background="./assets/san_francisco.svg">
<aside class="notes">
<p>Hi, my name is Sune, I&#39;m a software engineer at Zendesk.<br> I&#39;m
here to talk to you about property based testing with a
JavaScript assertion library called Unexpected that I&#39;m the
author of.
</aside></p>
</section></section><section class="section" id="section-1"><section class="slide" id="slide-1-0">
<h2 id="the-birth-of-unexpected-check">The birth of unexpected-check</h2>
<aside class="notes">
<p>Back in December I was speaking about testing with a coworker and he mentioned
that he was interested in property based testing and wanted to try it out in
practice.
I was interested so see if it was possible to support this kind of testing with
Unexpected.
</aside></p>
<aside class="notes">
<p>I just had one problem and that is time.
</aside></p>
</section><section class="slide" id="slide-1-1">
<p><img src="./assets/svea.jpg" style="height: 500px; display: inline-block">
<img src="./assets/neel.jpg" style="height: 500px; display: inline-block"></p>
<aside class="notes">
<p>Being a parent I still have time to think about things. So I basically
spend a month thinking about the problem.
</aside></p>
<aside class="notes">
<p>In January I was going on an onboarding trip with Zendesk for two weeks to San
Francisco. I knew I would have time to implemented a solution on this trip.
</aside></p>
</section><section class="slide" id="slide-1-2" data-background="./assets/copenhagen_to_san_francisco.png">

<aside class="notes">
<p>Luckily the flight happened to be one of the old SAS flights that haven&#39;t been
renewed, it had a really crappy entertainment system. So I kept awake for the
entire trip hacking on unexpected-check and chance-generators - and I managed to
make a working first version on that flight.
</aside></p>
</section><section class="slide" id="slide-1-3">
<p><a href="http://unexpected.js.org/unexpected-check">http://unexpected.js.org/unexpected-check</a></p>
</section></section><section class="section" id="section-2"><section class="slide" id="slide-2-0">
<p><img src="./assets/im_so_random.png" style="border: none"></p>
<h2 id="property-based-testing">Property based testing</h2>
<aside class="notes">
<p>Property based testing is also known generative testing or randomized testing.
The idea was introduced by Koen Claessen and John Hughes with the Haskell
library QuickCheck in 1999. But even though the idea is really old, property
based testing has only found popularity among functional programming languages
communities, which is a pity.
</aside></p>
<h4 id="-what-is-it-all-about-">-what is it all about?</h4>
</section><section class="slide" id="slide-2-1">
<p>Property based testings makes statements about a piece of code while being
exercised with data taken from a given input space.</p>
<aside class="notes">
<p>That sounds really hairy and academic, but it is basically just about generating
random input of a given form, exercise your code with the input and assert a set
of properties about your program.
</aside></p>
</section></section><section class="section" id="section-3"><section class="slide" id="slide-3-0">
<h3 id="problems-that-are-well-suited-for-property-based-testing">Problems that are well suited for property based testing</h3>
</section></section><section class="section" id="section-4"><section class="slide" id="slide-4-0">
<h3 id="functions-that-have-an-inverse-function">Functions that have an inverse function</h3>
</section><section class="slide" id="slide-4-1">
<ul>
<li>reverse</li>
<li>encode/decode</li>
<li>add/remove</li>
</ul>
<aside class="notes">
<p>many mathematical functions
</aside></p>
</section><section class="slide" id="slide-4-2">
<aside class="notes">
<p>let see an example.
</aside></p>
<p>Imagine we wanted to test the encodeURIComponent function.</p>
<aside class="notes">
<p>encodeURIComponent encode a string to be inserted as part of a URI.
</aside></p>
</section><section class="slide" id="slide-4-3">
<h3 id="example-based-testing">Example-based testing</h3>
<aside class="notes">
<p>how would we test this function with example based testing?
</aside></p>
<div class="code lang-javascript"><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">encodeURIComponent</span><span style="color: #000000">(</span><span style="color: #df5000">''</span><span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">''</span><span style="color: #000000">)</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">encodeURIComponent</span><span style="color: #000000">(</span><span style="color: #df5000">'Hello&nbsp;ATF'</span><span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'Hello%20ATF'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">encodeURIComponent</span><span style="color: #000000">(</span><span style="color: #df5000">'100%&nbsp;cool!'</span><span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'100%25%20cool!'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">encodeURIComponent</span><span style="color: #000000">(</span><span style="color: #df5000">'~&amp;?'</span><span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'~%26%3F'</span><span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-4-4">
<h3 id="property-based-testing">Property-based testing</h3>
<aside class="notes">
<p>Notice that the encodeURIComponent has the following property. If you
encode a string and decode it again you should get the same string back.
</aside></p>
<p>decodeURIComponent(encodeURIComponent(s)) = s</p>
</section><section class="slide" id="slide-4-5">
<aside class="notes">
<p>The chance-generators library is a generator layer on top of the excellent
<a href="http://chancejs.com/">http://chancejs.com/</a> library that enables us to use all the chancejs functions
as generators.
</aside></p>
<p>Let&#39;s start out by generating some strings:</p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;Generators&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">require</span><span style="color: #000000">(</span><span style="color: #df5000">'chance-generators'</span><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;natural<span style="color: #000000">,</span>&nbsp;string&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;strings&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">string</span><span style="color: #000000">({</span>&nbsp;length<span style="color: #000000">:</span>&nbsp;<span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">50</span>&nbsp;<span style="color: #000000">})})</span></div></div><aside class="notes">
<p>We use a seeded random as it is important that test are reproducible.
</aside></p>
</section><section class="slide" id="slide-4-6">
<div class="code lang-javascript"><div>expect<span style="color: #000000">.</span><span style="color: #000000">use</span><span style="color: #000000">(</span><span style="color: #000000">require</span><span style="color: #000000">(</span><span style="color: #df5000">'unexpected-check'</span><span style="color: #000000">))</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>string<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">decodeURIComponent</span><span style="color: #000000">(</span><span style="color: #000000">encodeURIComponent</span><span style="color: #000000">(</span>string<span style="color: #000000">)),</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;string</div><div>&nbsp;&nbsp;<span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;strings<span style="color: #000000">)</span></div></div><aside class="notes">
<p>it is tempting to just rely property based testing, but I would always
complement it with sanity checks.
</aside></p>
</section></section><section class="section" id="section-5"><section class="slide" id="slide-5-0">
<h3 id="functions-where-it-is-easier-to-check-the-result-than-computing-it">Functions where it is easier to check the result than computing it</h3>
</section><section class="slide" id="slide-5-1">
<ul>
<li>sorting</li>
<li>searching</li>
<li>most transformations</li>
</ul>
<aside class="notes">
<p>sorting - each items is less than or equal to the next item
searching - sorting for each item should yield the index of the item
</aside></p>
<aside class="notes">
<p>a huge amount of problems has this characteristics
</aside></p>
</section><section class="slide" id="slide-5-2">
<p><img src="./assets/sorting.jpg"></p>
<h2 id="testing-a-sorting-function">Testing a sorting function</h2>
<p>isSorted(sort(a)) = true</p>
</section><section class="slide" id="slide-5-3">
<div class="code lang-javascript"><div><span style="color: #a71d5d">function</span>&nbsp;isSortedAscending&nbsp;<span style="color: #000000">(</span>array<span style="color: #000000">)</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #a71d5d">return</span>&nbsp;array<span style="color: #000000">.</span><span style="color: #000000">every</span><span style="color: #000000">((</span>x<span style="color: #000000">,</span>&nbsp;i<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #a71d5d">return</span>&nbsp;array<span style="color: #000000">.</span><span style="color: #000000">slice</span><span style="color: #000000">(</span>i<span style="color: #000000">).</span><span style="color: #000000">every</span><span style="color: #000000">((</span>y<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;x&nbsp;<span style="color: #a71d5d">&lt;=</span>&nbsp;y<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">})</span></div><div><span style="color: #000000">}</span></div></div></section><section class="slide" id="slide-5-4">
<p>Let&#39;s make an assertion for checking<br>
that arrays are sorted ascending:</p>
<div class="code lang-javascript"><div>expect<span style="color: #000000">.</span><span style="color: #000000">addAssertion</span><span style="color: #000000">(</span><span style="color: #df5000">'to&nbsp;be&nbsp;sorted&nbsp;ascending'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #000000">(</span>expect<span style="color: #000000">,</span>&nbsp;subject<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">isSortedAscending</span><span style="color: #000000">(</span>subject<span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;true'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">})</span></div></div></section><section class="slide" id="slide-5-5">
<p>Quicksort sorts arrays of strings correctly</p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;quicksort&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">require</span><span style="color: #000000">(</span><span style="color: #df5000">'quicksort.js'</span><span style="color: #000000">);</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;array<span style="color: #000000">,</span>&nbsp;string&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;stringArrays&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">array</span><span style="color: #000000">(</span>string<span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>array<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span>quicksort<span style="color: #000000">.</span><span style="color: #000000">asc</span><span style="color: #000000">(</span>array<span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;sorted&nbsp;ascending'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;stringArrays<span style="color: #000000">)</span></div></div><aside class="notes">
<p>notice how we are testing both the isSortedAscending function and the
sorting function, property based testing will find bugs in your production code
as wells as in your testing code.
</aside></p>
</section><section class="slide" id="slide-5-6">
<p>...and integer arrays:</p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;array<span style="color: #000000">,</span>&nbsp;integer&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;integerArrays&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">array</span><span style="color: #000000">(</span></div><div>&nbsp;&nbsp;<span style="color: #000000">integer</span><span style="color: #000000">({</span>&nbsp;min<span style="color: #000000">:</span>&nbsp;<span style="color: #a71d5d">-</span><span style="color: #0086b3">100</span><span style="color: #000000">,</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">})</span></div><div><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>array<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span>quicksort<span style="color: #000000">.</span><span style="color: #000000">asc</span><span style="color: #000000">(</span>array<span style="color: #000000">),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;sorted&nbsp;ascending'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;integerArrays<span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-5-7">
<p>Let&#39;s try the same with the build-in sorting function:</p>
<div class="code lang-javascript"><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>array<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span>array<span style="color: #000000">.</span><span style="color: #000000">sort</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;sorted&nbsp;ascending'</span><span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;integerArrays<span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-5-8">
<p>And it fails!</p>
<p><img src="./assets/wat.jpg" alt="wat"></p>
<aside class="notes">
<p>Wat we can&#39;t even sort integers anymore, what is even happening?
</aside></p>
</section><section class="slide" id="slide-5-9">
<p>We get the following error:</p>
<div class="output"><div><span style="color: red; font-weight: bold">Ran&nbsp;</span><span style="color: #0086b3">1000</span>&nbsp;<span style="color: red; font-weight: bold">iterations&nbsp;and&nbsp;found&nbsp;</span><span style="color: #0086b3">20</span><span style="color: red; font-weight: bold">&nbsp;errors</span></div><div><span style="color: red; font-weight: bold">counterexample:</span></div><div>&nbsp;</div><div>&nbsp;&nbsp;<div style="display: inline-block; vertical-align: top"><div>Generated&nbsp;input:&nbsp;[&nbsp;<span style="color: #0086b3">10</span>,&nbsp;<span style="color: #0086b3">2</span>&nbsp;]</div><div>with:&nbsp;<span style="color: #795da3">n</span>(<span style="color: #795da3">integer</span>({&nbsp;<span style="color: #555">min</span>:&nbsp;<span style="color: #0086b3">-100</span>,&nbsp;<span style="color: #555">max</span>:&nbsp;<span style="color: #0086b3">100</span>&nbsp;}),&nbsp;<span style="color: #795da3">natural</span>({&nbsp;<span style="color: #555">max</span>:&nbsp;<span style="color: #0086b3">50</span>&nbsp;}))</div><div>&nbsp;</div><div><div style="display: inline-block; vertical-align: top"><div><span style="color: red; font-weight: bold">expected</span>&nbsp;[&nbsp;<span style="color: #0086b3">10</span>,&nbsp;<span style="color: #0086b3">2</span>&nbsp;]&nbsp;<span style="color: red; font-weight: bold">to&nbsp;be&nbsp;sorted&nbsp;ascending</span></div></div></div></div></div></div><aside class="notes">
<p>The explanation: build-in search sort alphabetically based on string
conversion.
</aside></p>
</section></section><section class="section" id="section-6"><section class="slide" id="slide-6-0">
<h3 id="objects-that-maintains-an-invariant">Objects that maintains an invariant</h3>
</section><section class="slide" id="slide-6-1">
<ul>
<li>sets</li>
<li>queues</li>
<li>balanced search trees</li>
</ul>
<aside class="notes">
<p>sets - no duplicates
queues - items are retrieved in the same order they are inserted
balanced search trees - stays balanced
</aside></p>
</section><section class="slide" id="slide-6-2">
<h2 id="testing-a-queue">Testing a queue</h2>
<p><img src="./assets/queue.jpg"></p>
<p>While adding and removing items, the items should always be retrieved in the
same order they where inserted.</p>
<aside class="notes">
<p>the way we are going to test the queue is to simulate operations on the
queue and check that it maintains this property.
</aside></p>
</section><section class="slide" id="slide-6-3">
<p>Let&#39;s generate some operations:</p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;array<span style="color: #000000">,</span>&nbsp;integer<span style="color: #000000">,</span>&nbsp;pickone<span style="color: #000000">,</span>&nbsp;shape&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;addOperation&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">shape</span><span style="color: #000000">({</span></div><div>&nbsp;&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'add'</span><span style="color: #000000">,</span></div><div>&nbsp;&nbsp;value<span style="color: #000000">:</span>&nbsp;integer</div><div><span style="color: #000000">})</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;removeOperation&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">shape</span><span style="color: #000000">({</span></div><div>&nbsp;&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span></div><div><span style="color: #000000">})</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;operations&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">array</span><span style="color: #000000">(</span></div><div>&nbsp;&nbsp;<span style="color: #000000">pickone</span><span style="color: #000000">([</span>addOperation<span style="color: #000000">,</span>&nbsp;removeOperation<span style="color: #000000">])</span></div><div><span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-6-4">
<p>This will generate arrays with the following structure:</p>
<div class="code lang-javascript"><div><span style="color: #000000">[</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'add'</span><span style="color: #000000">,</span>&nbsp;value<span style="color: #000000">:</span>&nbsp;<span style="color: #a71d5d">-</span><span style="color: #0086b3">1331529414344704</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'add'</span><span style="color: #000000">,</span>&nbsp;value<span style="color: #000000">:</span>&nbsp;<span style="color: #a71d5d">-</span><span style="color: #0086b3">4654237011148800</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'add'</span><span style="color: #000000">,</span>&nbsp;value<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">3344884333281280</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;<span style="color: #000000">},</span></div><div>&nbsp;&nbsp;<span style="color: #000000">{</span>&nbsp;type<span style="color: #000000">:</span>&nbsp;<span style="color: #df5000">'add'</span><span style="color: #000000">,</span>&nbsp;value<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">1939033726910464</span>&nbsp;<span style="color: #000000">}</span></div><div><span style="color: #000000">]</span></div></div></section><section class="slide" id="slide-6-5">
<div class="code lang-javascript"><div><span style="color: #a71d5d">function</span>&nbsp;<span style="color: #000000">execute</span><span style="color: #000000">(</span>queue<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;const&nbsp;added&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">[],</span>&nbsp;removed&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">[]</span></div><div>&nbsp;&nbsp;operations<span style="color: #000000">.</span><span style="color: #000000">forEach</span><span style="color: #000000">(({</span>&nbsp;type<span style="color: #000000">,</span>&nbsp;value&nbsp;<span style="color: #000000">})</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #a71d5d">if</span>&nbsp;<span style="color: #000000">(</span>type&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #df5000">'add'</span>&nbsp;&amp;&amp;&nbsp;<span style="color: #a71d5d">!</span>queue<span style="color: #000000">.</span><span style="color: #000000">isFull</span><span style="color: #000000">())</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<span style="color: #000000">.</span><span style="color: #000000">offer</span><span style="color: #000000">(</span>value<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;added<span style="color: #000000">.</span><span style="color: #000000">push</span><span style="color: #000000">(</span>value<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">else</span>&nbsp;<span style="color: #a71d5d">if</span>&nbsp;<span style="color: #000000">(</span>type&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;&amp;&amp;&nbsp;<span style="color: #a71d5d">!</span>queue<span style="color: #000000">.</span><span style="color: #000000">isEmpty</span><span style="color: #000000">())</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removed<span style="color: #000000">.</span><span style="color: #000000">push</span><span style="color: #000000">(</span>queue<span style="color: #000000">.</span><span style="color: #000000">poll</span><span style="color: #000000">())</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">}</span></div><div>&nbsp;&nbsp;<span style="color: #000000">})</span></div><div>&nbsp;</div><div>&nbsp;&nbsp;<span style="color: #a71d5d">return</span>&nbsp;<span style="color: #000000">{</span>&nbsp;added<span style="color: #000000">,</span>&nbsp;removed&nbsp;<span style="color: #000000">}</span></div><div><span style="color: #000000">}</span></div></div></section><section class="slide" id="slide-6-6">
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;CircularQueue&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">require</span><span style="color: #000000">(</span><span style="color: #df5000">'circular-queue'</span><span style="color: #000000">);</span></div><div><span style="color: #a71d5d">var</span>&nbsp;capacities&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;min<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">50</span>&nbsp;<span style="color: #000000">})</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>capacity<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;const&nbsp;queue&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;CircularQueue<span style="color: #000000">(</span>capacity<span style="color: #000000">);</span></div><div>&nbsp;&nbsp;const&nbsp;<span style="color: #000000">{</span>&nbsp;added<span style="color: #000000">,</span>&nbsp;removed&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">execute</span><span style="color: #000000">(</span>queue<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;removed<span style="color: #000000">,</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;added<span style="color: #000000">.</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">0</span><span style="color: #000000">,</span>&nbsp;added<span style="color: #000000">.</span>length&nbsp;<span style="color: #a71d5d">-</span>&nbsp;queue<span style="color: #000000">.</span>size<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;capacities<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-6-7">
<p>Reuse generated operations:</p>
<div class="code lang-javascript"><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #a71d5d">function</span>&nbsp;<span style="color: #000000">(</span>capacity<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;const&nbsp;queue&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;CircularQueue<span style="color: #000000">(</span>capacity<span style="color: #000000">);</span></div><div>&nbsp;&nbsp;operations<span style="color: #000000">.</span><span style="color: #000000">forEach</span><span style="color: #000000">(({</span>&nbsp;type<span style="color: #000000">,</span>&nbsp;value&nbsp;<span style="color: #000000">})</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;currentSize&nbsp;<span style="color: #a71d5d">=</span>&nbsp;queue<span style="color: #000000">.</span>size</div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #a71d5d">if</span>&nbsp;<span style="color: #000000">(</span>type&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #df5000">'add'</span>&nbsp;&amp;&amp;&nbsp;<span style="color: #a71d5d">!</span>queue<span style="color: #000000">.</span><span style="color: #000000">isFull</span><span style="color: #000000">())</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<span style="color: #000000">.</span><span style="color: #000000">offer</span><span style="color: #000000">(</span>value<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span>queue<span style="color: #000000">.</span>size<span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;currentSize&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">)</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">else</span>&nbsp;<span style="color: #a71d5d">if</span>&nbsp;<span style="color: #000000">(</span>type&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #df5000">'remove'</span>&nbsp;&amp;&amp;&nbsp;<span style="color: #a71d5d">!</span>queue<span style="color: #000000">.</span><span style="color: #000000">isEmpty</span><span style="color: #000000">())</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<span style="color: #000000">.</span><span style="color: #000000">poll</span><span style="color: #000000">()</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span>queue<span style="color: #000000">.</span>size<span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;currentSize&nbsp;<span style="color: #a71d5d">-</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">)</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">}</span></div><div>&nbsp;&nbsp;<span style="color: #000000">})</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;capacities<span style="color: #000000">,</span>&nbsp;operations<span style="color: #000000">)</span></div></div></section></section><section class="section" id="section-7"><section class="slide" id="slide-7-0">
<h2 id="input-shrinking">Input shrinking</h2>
<p><img src="./assets/ShrinkingSam.jpg"></p>
<aside class="notes">
<p>the inputs generated by chance-generators will usually be huge and
unmanageable. Shrinking is the process of generating a smaller failing example.
</aside></p>
</section><section class="slide" id="slide-7-1">
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;arrayEqual&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">require</span><span style="color: #000000">(</span><span style="color: #df5000">'array-equal'</span><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">function</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">(</span>array<span style="color: #000000">,</span>&nbsp;subArray<span style="color: #000000">)</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #a71d5d">return</span>&nbsp;array<span style="color: #000000">.</span><span style="color: #000000">some</span><span style="color: #000000">((</span>v<span style="color: #000000">,</span>&nbsp;i<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">(</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">arrayEqual</span><span style="color: #000000">(</span>array<span style="color: #000000">.</span><span style="color: #000000">slice</span><span style="color: #000000">(</span>i<span style="color: #000000">,</span>&nbsp;i&nbsp;<span style="color: #a71d5d">+</span>&nbsp;subArray<span style="color: #000000">.</span>length<span style="color: #000000">),</span>&nbsp;subArray<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">))</span></div><div><span style="color: #000000">}</span></div></div><aside class="notes">
<p>can anybody spot the error?
</aside></p>
</section><section class="slide" id="slide-7-2">
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;array<span style="color: #000000">,</span>&nbsp;integer<span style="color: #000000">,</span>&nbsp;natural&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">314</span><span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;lengths&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">})</span></div><div><span style="color: #a71d5d">var</span>&nbsp;arrays&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">array</span><span style="color: #000000">(</span>integer<span style="color: #000000">,</span>&nbsp;lengths<span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;offsets&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">})</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">((</span>array<span style="color: #000000">,</span>&nbsp;offset<span style="color: #000000">,</span>&nbsp;length<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;const&nbsp;subArray&nbsp;<span style="color: #a71d5d">=</span>&nbsp;array<span style="color: #000000">.</span><span style="color: #000000">slice</span><span style="color: #000000">(</span>offset<span style="color: #000000">,</span>&nbsp;offset&nbsp;<span style="color: #a71d5d">+</span>&nbsp;length<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">expect</span><span style="color: #000000">(</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;containsSubArray<span style="color: #000000">,</span>&nbsp;<span style="color: #df5000">'when&nbsp;called&nbsp;with'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #000000">[</span>array<span style="color: #000000">,</span>&nbsp;subArray<span style="color: #000000">],</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;true'</span></div><div>&nbsp;&nbsp;<span style="color: #000000">)</span></div><div><span style="color: #000000">},</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;valid&nbsp;for&nbsp;all'</span><span style="color: #000000">,</span>&nbsp;arrays<span style="color: #000000">,</span>&nbsp;offsets<span style="color: #000000">,</span>&nbsp;lengths<span style="color: #000000">)</span></div></div></section><section class="slide" id="slide-7-3">
<div class="output"><div><span style="color: red; font-weight: bold">Ran&nbsp;</span><span style="color: #0086b3">14</span>&nbsp;<span style="color: red; font-weight: bold">iterations&nbsp;and&nbsp;found&nbsp;</span><span style="color: #0086b3">14</span><span style="color: red; font-weight: bold">&nbsp;errors</span></div><div><span style="color: red; font-weight: bold">counterexample:</span></div><div>&nbsp;</div><div>&nbsp;&nbsp;<div style="display: inline-block; vertical-align: top"><div>Generated&nbsp;input:&nbsp;[],&nbsp;<span style="color: #0086b3">0</span>,&nbsp;<span style="color: #0086b3">0</span></div><div>with:&nbsp;<span style="color: #795da3">n</span>(<span style="color: #795da3">integer</span>,&nbsp;<span style="color: #795da3">natural</span>({&nbsp;<span style="color: #555">max</span>:&nbsp;<span style="color: #0086b3">100</span>&nbsp;})),&nbsp;<span style="color: #795da3">natural</span>({&nbsp;<span style="color: #555">max</span>:&nbsp;<span style="color: #0086b3">100</span>&nbsp;}),&nbsp;<span style="color: #795da3">natural</span>({&nbsp;<span style="color: #555">max</span>:&nbsp;<span style="color: #0086b3">100</span>&nbsp;})</div><div>&nbsp;</div><div><div style="display: inline-block; vertical-align: top"><div><span style="color: red; font-weight: bold">expected</span></div><div><span style="color: #a71d5d">function</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">(</span>array<span style="color: #000000">,</span>&nbsp;subArray<span style="color: #000000">)</span>&nbsp;<span style="color: #000000">{</span></div><div>&nbsp;&nbsp;<span style="color: #a71d5d">return</span>&nbsp;array<span style="color: #000000">.</span><span style="color: #000000">some</span><span style="color: #000000">((</span>v<span style="color: #000000">,</span>&nbsp;i<span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">(</span></div><div>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #000000">arrayEqual</span><span style="color: #000000">(</span>array<span style="color: #000000">.</span><span style="color: #000000">slice</span><span style="color: #000000">(</span>i<span style="color: #000000">,</span>&nbsp;i&nbsp;<span style="color: #a71d5d">+</span>&nbsp;subArray<span style="color: #000000">.</span>length<span style="color: #000000">),</span>&nbsp;subArray<span style="color: #000000">)</span></div><div>&nbsp;&nbsp;<span style="color: #000000">))</span></div><div><span style="color: #000000">}</span></div><div><span style="color: red; font-weight: bold">when&nbsp;called&nbsp;with</span>&nbsp;[],&nbsp;[]&nbsp;<span style="color: red; font-weight: bold">to&nbsp;be&nbsp;true</span></div><div>&nbsp;&nbsp;<div style="display: inline-block; vertical-align: top"><div><span style="color: red; font-weight: bold">expected</span>&nbsp;<span style="color: #0086b3">false</span>&nbsp;<span style="color: red; font-weight: bold">to&nbsp;be&nbsp;true</span></div></div></div></div></div></div></div></div></section><section class="slide" id="slide-7-4">
<p>The assertion finds an error in the first iteration and shrinks it to the
optimal output in 14 iterations. Here are the last iterations:</p>
<div class="code lang-javascript"><div><span style="color: #000000">...</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">3</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">3</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">3</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">3</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">3</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">2</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">3</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">2</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">2</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">3</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">1</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">1</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div><div><span style="color: #000000">input</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">)</span>&nbsp;<span style="color: #a71d5d">=&gt;</span>&nbsp;<span style="color: #000000">containsSubArray</span><span style="color: #000000">([],</span>&nbsp;<span style="color: #000000">[].</span><span style="color: #000000">slice</span><span style="color: #000000">(</span><span style="color: #0086b3">0</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span>&nbsp;<span style="color: #a71d5d">+</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">))</span>&nbsp;<span style="color: #a71d5d">===</span>&nbsp;<span style="color: #0086b3">true</span></div></div></section><section class="slide" id="slide-7-5">
<p>Shrinking a number:</p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;integer&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;numbers&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">integer</span><span style="color: #000000">({</span>&nbsp;min<span style="color: #000000">:</span>&nbsp;<span style="color: #a71d5d">-</span><span style="color: #0086b3">100</span><span style="color: #000000">,</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">})</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;shrunkenGenerator&nbsp;<span style="color: #a71d5d">=</span>&nbsp;numbers<span style="color: #000000">.</span><span style="color: #000000">shrink</span><span style="color: #000000">(</span><span style="color: #0086b3">22</span><span style="color: #000000">)</span></div><div><span style="color: #969896">//&nbsp;will&nbsp;return:&nbsp;integer({&nbsp;min:&nbsp;0,&nbsp;&nbsp;max:&nbsp;22&nbsp;})&nbsp;</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">shrunkenGenerator</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;within'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">22</span><span style="color: #000000">)</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;shrunkenGenerator&nbsp;<span style="color: #a71d5d">=</span>&nbsp;numbers<span style="color: #000000">.</span><span style="color: #000000">shrink</span><span style="color: #000000">(</span><span style="color: #a71d5d">-</span><span style="color: #0086b3">33</span><span style="color: #000000">)</span>&nbsp;</div><div><span style="color: #969896">//&nbsp;will&nbsp;return:&nbsp;integer({&nbsp;min:&nbsp;-33,&nbsp;max:&nbsp;0&nbsp;})&nbsp;</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">shrunkenGenerator</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;be&nbsp;within'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #a71d5d">-</span><span style="color: #0086b3">33</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">0</span><span style="color: #000000">)</span></div></div><p>The shrunken values will converge towards zero.</p>
</section><section class="slide" id="slide-7-6">
<p>Shrinking an array: </p>
<div class="code lang-javascript"><div><span style="color: #a71d5d">var</span>&nbsp;<span style="color: #000000">{</span>&nbsp;array<span style="color: #000000">,</span>&nbsp;natural&nbsp;<span style="color: #000000">}</span>&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #a71d5d">new</span>&nbsp;Generators<span style="color: #000000">(</span><span style="color: #0086b3">42</span><span style="color: #000000">)</span></div><div><span style="color: #a71d5d">var</span>&nbsp;arrays&nbsp;<span style="color: #a71d5d">=</span>&nbsp;<span style="color: #000000">array</span><span style="color: #000000">(</span><span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">}),</span>&nbsp;<span style="color: #000000">natural</span><span style="color: #000000">({</span>&nbsp;min<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">2</span><span style="color: #000000">,</span>&nbsp;max<span style="color: #000000">:</span>&nbsp;<span style="color: #0086b3">100</span>&nbsp;<span style="color: #000000">}))</span></div><div>&nbsp;</div><div><span style="color: #a71d5d">var</span>&nbsp;shrunkenGenerator&nbsp;<span style="color: #a71d5d">=</span>&nbsp;arrays<span style="color: #000000">.</span><span style="color: #000000">shrink</span><span style="color: #000000">([</span><span style="color: #0086b3">79</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">25</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">42</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">94</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">27</span><span style="color: #000000">])</span></div><div><span style="color: #969896">//&nbsp;will&nbsp;return:&nbsp;pickset([79,&nbsp;25,&nbsp;42,&nbsp;94,&nbsp;27],&nbsp;natural({&nbsp;min:&nbsp;2,&nbsp;max:&nbsp;5&nbsp;})&nbsp;</span></div><div>&nbsp;</div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">shrunkenGenerator</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #000000">[</span>&nbsp;<span style="color: #0086b3">94</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">27</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">79</span>&nbsp;<span style="color: #000000">])</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">shrunkenGenerator</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #000000">[</span>&nbsp;<span style="color: #0086b3">42</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">79</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">94</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">25</span>&nbsp;<span style="color: #000000">])</span></div><div><span style="color: #000000">expect</span><span style="color: #000000">(</span><span style="color: #000000">shrunkenGenerator</span><span style="color: #000000">(),</span>&nbsp;<span style="color: #df5000">'to&nbsp;equal'</span><span style="color: #000000">,</span>&nbsp;<span style="color: #000000">[</span>&nbsp;<span style="color: #0086b3">42</span><span style="color: #000000">,</span>&nbsp;<span style="color: #0086b3">27</span>&nbsp;<span style="color: #000000">])</span></div></div><p>The shrunken arrays will converge towards the smallest possible array.</p>
</section></section><section class="section" id="section-8"><section class="slide" id="slide-8-0" data-background="./assets/crystal-ball.jpg">
<p style="color: white; position: fixed; top: 20px; left: 0px; width: 100%;">What will the future bring?</p>


</section><section class="slide" id="slide-8-1">
<h2 id="improved-shrinking">Improved shrinking</h2>
<h3 id="shrinking-nested-generators">Shrinking nested generators</h3>
</section><section class="slide" id="slide-8-2">
<p>The sorting failure we saw earlier: <code>[-45,-95]</code><br>
should have been: <code>[10,2]</code>.</p>
<p><em>Done</em></p>
</section><section class="slide" id="slide-8-3">
<h2 id="more-generators">More generators</h2>
<aside class="notes">
<p>unexpected-check can use any kind of function that returns a value as a
generator. If it has a shrink method on the function, it will use that for
shrinking.
</aside></p>
</section><section class="slide" id="slide-8-4">
<ul>
<li>json-schema-faker</li>
<li>immutable-js generators</li>
<li>Generator for React prop types</li>
</ul>
</section><section class="slide" id="slide-8-5">
<h2 id="support-asynchronous-assertions">Support asynchronous assertions</h2>
</section><section class="slide" id="slide-8-6">
<p>Useful for testing for race conditions with random executions plans.</p>
<aside class="notes">
<p>Testing the action executor.
</aside></p>
<p><em>Done</em></p>
</section></section><section class="section" id="section-9"><section class="slide" id="slide-9-0">
<h2 id="questions">Questions</h2>
</section></section><section class="section" id="section-10"><section class="slide" id="slide-10-0">
<h2 id="real-world-example">Real world example</h2>
<h4 id="testing-menu-positioning">Testing menu positioning</h4>
<aside class="notes">
<p>maybe a drawing
</aside></p>
</section></section><section class="section" id="section-11"><section class="slide" id="slide-11-0">
<h2 id="the-end">The end</h2>
</section></section></article><script src="./static/vanilla-touchwipe.js"></script><script src="./static/presentation.js"></script></body></html>